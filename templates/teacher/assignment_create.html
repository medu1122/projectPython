{% extends "layout.html" %}

{% block title %}Create Assignment - Learning Management System{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0"><i class="fas fa-plus mr-2"></i>Create New Assignment</h3>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('teacher_create_assignment') }}" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="title" class="form-label">Assignment Title *</label>
                            <input type="text" class="form-control" id="title" name="title" required>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="course_id" class="form-label">Course *</label>
                                <select class="form-select" id="course_id" name="course_id" required>
                                    <option value="">Select Course</option>
                                    {% for course in courses or [] %}
                                        <option value="{{ course.id }}">{{ course.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="type" class="form-label">Assignment Type *</label>
                                <select class="form-select" id="type" name="type" required onchange="toggleTypeFields()">
                                    <option value="">Select Type</option>
                                    <option value="code">Code Assignment</option>
                                    <option value="quiz">Quiz</option>
                                    <option value="file">File Upload</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="description" class="form-label">Description *</label>
                            <textarea class="form-control" id="description" name="description" rows="4" required placeholder="Provide clear instructions for your students..."></textarea>
                        </div>
                        <!-- Type-Specific Fields -->
                        <div id="codeFields" style="display:none;">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="language" class="form-label">Programming Language</label>
                                    <select class="form-select" id="language" name="language">
                                        <option value="python">Python</option>
                                        <option value="javascript">JavaScript</option>
                                        <option value="java">Java</option>
                                        <option value="cpp">C++</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="time_limit" class="form-label">Time Limit (minutes)</label>
                                    <input type="number" class="form-control" id="time_limit" name="time_limit" value="30" min="1" max="300">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="test_cases" class="form-label">Test Cases (JSON format)</label>
                                <textarea class="form-control" id="test_cases" name="test_cases" rows="4" placeholder='[{"input": "5", "output": "25"}, {"input": "10", "output": "100"}]'></textarea>
                            </div>
                        </div>
                        <div id="fileFields" style="display:none;">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="allowed_extensions" class="form-label">Allowed File Types</label>
                                    <input type="text" class="form-control" id="allowed_extensions" name="allowed_extensions" placeholder="pdf,docx,zip,jpg,png">
                                </div>
                                <div class="col-md-6">
                                    <label for="max_file_size" class="form-label">Max File Size (MB)</label>
                                    <input type="number" class="form-control" id="max_file_size" name="max_file_size" value="10" min="1" max="50">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="due_date" class="form-label">Due Date *</label>
                                <input type="datetime-local" class="form-control" id="due_date" name="due_date" required>
                            </div>
                            <div class="col-md-6">
                                <label for="max_score" class="form-label">Maximum Score *</label>
                                <input type="number" class="form-control" id="max_score" name="max_score" value="100" min="0" required>
                            </div>
                        </div>
                        <div class="mb-3 form-check">
                            <input class="form-check-input" type="checkbox" id="is_active" name="is_active" checked>
                            <label class="form-check-label" for="is_active">Active Assignment</label>
                        </div>
                        <div class="mb-3 form-check">
                            <input class="form-check-input" type="checkbox" id="allow_late_submission" name="allow_late_submission">
                            <label class="form-check-label" for="allow_late_submission">Allow Late Submissions</label>
                        </div>
                        <div class="mb-3">
                            <label for="attachment" class="form-label">Supporting Files (Optional)</label>
                            <input type="file" class="form-control" id="attachment" name="attachment" multiple>
                            <small class="form-text text-muted">Upload any supporting materials for this assignment.</small>
                        </div>
                        <div class="d-flex justify-content-between">
                            <a href="{{ url_for('teacher_assignments') }}" class="btn btn-secondary">Cancel</a>
                            <button type="submit" class="btn btn-success"><i class="fas fa-save mr-1"></i>Create Assignment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function toggleTypeFields() {
    const type = document.getElementById('type').value;
    document.getElementById('codeFields').style.display = type === 'code' ? 'block' : 'none';
    document.getElementById('fileFields').style.display = type === 'file' ? 'block' : 'none';
}
// Set default due date to 1 week from now
window.addEventListener('DOMContentLoaded', function() {
    const dueDateInput = document.getElementById('due_date');
    if (dueDateInput) {
        const now = new Date();
        now.setDate(now.getDate() + 7);
        dueDateInput.value = now.toISOString().slice(0, 16);
    }
});
</script>
{% endblock %} 